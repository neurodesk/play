<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/pr-630/static/favicons/favicon.ico><link rel=apple-touch-icon href=/pr-630/static/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/pr-630/static/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/pr-630/static/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pr-630/static/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/pr-630/static/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/pr-630/static/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/pr-630/static/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/pr-630/static/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/pr-630/static/favicons/android-192x192.png sizes=192x192><title>Statistical Parametric Mapping (SPM) | Neurodesk</title>
<meta name=description content="A tutorial for running a functional MRI analysis in SPM."><meta property="og:url" content="https://neurodesk.github.io/pr-630/tutorials-examples/tutorials/functional_imaging/spm/"><meta property="og:site_name" content="Neurodesk"><meta property="og:title" content="Statistical Parametric Mapping (SPM)"><meta property="og:description" content="A tutorial for running a functional MRI analysis in SPM."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="tutorials-examples"><meta property="article:modified_time" content="2023-06-06T15:25:54+10:00"><meta property="article:tag" content="SPM"><meta property="article:tag" content="Functional Imaging"><meta itemprop=name content="Statistical Parametric Mapping (SPM)"><meta itemprop=description content="A tutorial for running a functional MRI analysis in SPM."><meta itemprop=dateModified content="2023-06-06T15:25:54+10:00"><meta itemprop=wordCount content="876"><meta itemprop=keywords content="SPM,Functional Imaging"><meta name=twitter:card content="summary"><meta name=twitter:title content="Statistical Parametric Mapping (SPM)"><meta name=twitter:description content="A tutorial for running a functional MRI analysis in SPM."><link href=/pr-630/scss/main.css rel=stylesheet><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3.8.2 integrity="sha512-l7pkV1dOURFyHCeH8I4fK9lCkQKuqhlsTCqRl3zktifDlB8oTUJ+mJPgYkK9kHpUut8j1iPquTv32t6hvTPv3g==" crossorigin=anonymous></head><body class=td-page><header><nav class="td-navbar navbar-expand-xl navbar-dark bg-dark"><div class="container-fluid flex-md-row"><a class=navbar-brand href=/pr-630/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" viewBox="0 0 560.3 82.7"><defs><style>.st0{isolation:isolate}.st1{fill:#6ba442}.st2{fill:#fff}</style></defs><g class="st0"><path class="st2" d="M30.2 73.4h-9.9v-60h9.8l33.3 44.8V13.4h10.1v60H63.4L30.1 29.1v44.3z"/><path class="st2" d="M85.8 13.4h45l-1.4 10.3-33.8-.2v13.6l20.1-.2v11.4H95.6v13.5H129l1.8 11.6h-45v-60z"/><path class="st2" d="M141.4 13.4h9.9v50.2h28.2V13.4h9.9v51.4c0 1.2-.2 2.3-.7 3.3-.4 1-1.1 2-1.8 2.7-.8.8-1.7 1.4-2.8 1.8-1.1.4-2.2.7-3.3.7h-30.7c-1.2.0-2.3-.2-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7s-.7-2.2-.7-3.3V13.4z"/><path class="st2" d="M244.7 34.8c0 4.6-1.4 7.9-4.3 10-4 2.9-8.4 4.4-13.2 4.4l17.5 24.3h-12.1l-14.7-24h-9.5v24h-8.5V13.4h29.8c10 0 15 4.9 15 14.6v6.8zm-36.3 6h15.2c3.9-.2 6.6-.7 8-1.6 2.6-1.8 3.9-2.9 3.9-3.5V29c0-2.2-.6-3.9-1.7-5-1.4-1.4-3-2.1-4.7-2.1h-20.8v18.9z"/><path class="st2" d="M306.5 59.4c0 4.8-.3 7.7-.6 8.7-.3.9-.9 1.8-1.8 2.8s-1.7 1.3-3.1 1.8c-1.3.5-3.6.7-6.8.7h-27.1c-1.2.0-2.8-.2-5-.6-2.5-.5-3.9-1.1-4.4-1.8-.9-1.5-1.6-2.4-1.8-2.7-.4-.6-.7-3.6-.7-8.7V42.1c0-8.8.0-14.1.2-15.9.0-2.6.3-5 .7-7.4.1-.8.7-1.7 1.7-2.7.6-.7 2.1-1.3 4.4-1.8 1.9-.4 3.5-.7 5-.7h27.1c3.5.0 5.7.1 6.8.6 1.3.5 2.3 1.1 3.1 1.9.9.8 1.5 1.7 2 2.7.4.8.6 3.3.6 7.4l.2 16.7c0 8.1-.1 13.6-.3 16.7zM265.4 23.3v40h31.2v-40h-31.2z"/></g><g class="st0"><path class="st1" d="M316.2 73.4v-60l31.3.3c2.5.0 5.4.6 8.7 1.9 2.6 1 4.8 2.4 6.6 4.3 2 2 3.4 4.2 4.3 6.6 1 3 1.5 5.9 1.5 8.7v17.3c0 3.2-.5 6.1-1.5 8.7s-2.4 4.8-4.2 6.6-4 3.2-6.6 4.2-5.5 1.5-8.7 1.5h-31.3zm30.7-11.2c4.9.0 8-.7 9.2-2 2.1-2.3 3.2-5.8 3.2-10.4v-14c.2-1.9-.2-3.6-1.1-5.2-.8-1.5-1.8-2.8-2.9-3.9-1.1-1.1-2.4-1.9-3.9-2.4-1.5-.6-3-.8-4.4-.8h-21.3v38.8h21.2z"/><path class="st1" d="M381 13.4h45l-1.4 10.3-33.8-.2v13.6l20.1-.2v11.4h-20.1v13.5h33.4l1.8 11.6h-45v-60z"/><path class="st1" d="M446.4 46.5c-1.1.0-2.2-.3-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7-.4-1-.7-2.2-.7-3.3V22.1c0-1.2.2-2.3.7-3.3s1.1-2 1.8-2.7 1.7-1.4 2.8-1.8 2.2-.7 3.3-.7h29.1c1.2.0 2.3.2 3.3.7s1.9 1.1 2.7 1.8c1.1 1 1.7 2 1.8 2.8l.7 3.3v6.7l-9 2.7v-7.7h-28.7v14.3l29.1.5c1.2.0 2.3.3 3.3.7 1.1.4 2 1.1 2.8 1.8.8.8 1.4 1.7 1.8 2.7.4 1 .7 2.2.7 3.3V65c0 1.2-.2 2.3-.7 3.3-.4 1-1.1 2-1.8 2.7-.8.8-1.7 1.4-2.7 1.8-1 .4-2.1.7-3.3.7h-30c-1.2.0-2.3-.2-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7-.4-1-.7-2.2-.7-3.3v-7.7l9.5-1.6v7.7h28.7V47.2l-28.7-.5z"/><path class="st1" d="M505.4 13.4v23.9l26.2-23.9h12.9l-30.8 27.4 32.1 32.6h-12.9l-27.5-28.1v28.1h-10.6v-60h10.6z"/></g></svg></span></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=main_navbar><ul class="navbar-nav ms-auto mt-2 mt-lg-0"><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=/pr-630/overview/><span>Overview</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=/pr-630/getting-started/><span>Getting Started</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class="nav-link active" href=/pr-630/tutorials-examples/><span class=active>Tutorials & Examples</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=/pr-630/developers/><span>Developer Documentation</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/neurodesk target=_blank><span>GitHub</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=/pr-630/contact/><span>Contact</span></a></li></ul><div class="navbar-nav d-lg-block"><div class=td-search><div class=td-search--algolia id=docsearch-0></div></div></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class=td-search><div class=td-search--algolia id=docsearch-0></div></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-pr-630tutorials-examples-li><a href=/pr-630/tutorials-examples/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-pr-630tutorials-examples><span>Tutorials & Examples</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplesexamples-li><a href=/pr-630/tutorials-examples/examples/ title=Examples class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplesexamples><span>Example Notebooks</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-pr-630tutorials-examplestutorials-li><a href=/pr-630/tutorials-examples/tutorials/ title=Tutorials class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorials><span>Tutorials section</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplestutorialselectrophysiology-li><a href=/pr-630/tutorials-examples/tutorials/electrophysiology/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialselectrophysiology><span>Electrophysiology</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialselectrophysiologyfieldtrip-li><a href=/pr-630/tutorials-examples/tutorials/electrophysiology/fieldtrip/ title="Analysing M/EEG Data with FieldTrip" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialselectrophysiologyfieldtrip><span>fieldtrip</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialselectrophysiologyeeg_mne-python-li><a href=/pr-630/tutorials-examples/tutorials/electrophysiology/eeg_mne-python/ title="Analysing EEG Data with MNE" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialselectrophysiologyeeg_mne-python><span>MNE-Python: EEG</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-pr-630tutorials-examplestutorialsfunctional_imaging-li><a href=/pr-630/tutorials-examples/tutorials/functional_imaging/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialsfunctional_imaging><span>Functional Imaging</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsfunctional_imagingconnectomeworkbench-li><a href=/pr-630/tutorials-examples/tutorials/functional_imaging/connectomeworkbench/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsfunctional_imagingconnectomeworkbench><span>Connectome Workbench</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsfunctional_imagingfmriprep-li><a href=/pr-630/tutorials-examples/tutorials/functional_imaging/fmriprep/ title="Using fmriprep with neurodesk on an HPC" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsfunctional_imagingfmriprep><span>fmriprep</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsfunctional_imagingmriqc-li><a href=/pr-630/tutorials-examples/tutorials/functional_imaging/mriqc/ title="Using mriqc with neurodesk on HPC" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsfunctional_imagingmriqc><span>mriqc</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsfunctional_imagingphysio-li><a href=/pr-630/tutorials-examples/tutorials/functional_imaging/physio/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsfunctional_imagingphysio><span>PhysIO</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsfunctional_imagingphysio_batch_workflow-li><a href=/pr-630/tutorials-examples/tutorials/functional_imaging/physio_batch_workflow/ title="A batch scripting example for PhysIO toolbox" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsfunctional_imagingphysio_batch_workflow><span>PhysIO_Batch</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-pr-630tutorials-examplestutorialsfunctional_imagingspm-li><a href=/pr-630/tutorials-examples/tutorials/functional_imaging/spm/ title="Statistical Parametric Mapping (SPM)" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsfunctional_imagingspm><span class=td-sidebar-nav-active-item>SPM</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplestutorialsphase_processing-li><a href=/pr-630/tutorials-examples/tutorials/phase_processing/ title="MRI phase Processing" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialsphase_processing><span>MRI Phase</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsphase_processingqsm-li><a href=/pr-630/tutorials-examples/tutorials/phase_processing/qsm/ title="Quantitative Susceptibility Mapping" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsphase_processingqsm><span>QSM</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsphase_processingswi-li><a href=/pr-630/tutorials-examples/tutorials/phase_processing/swi/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsphase_processingswi><span>SWI</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsphase_processingunwrapping-li><a href=/pr-630/tutorials-examples/tutorials/phase_processing/unwrapping/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsphase_processingunwrapping><span>Unwrapping</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplestutorialsmultimodal_imaging-li><a href=/pr-630/tutorials-examples/tutorials/multimodal_imaging/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialsmultimodal_imaging><span>Multimodal Imaging</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsmultimodal_imagingmfcsc-li><a href=/pr-630/tutorials-examples/tutorials/multimodal_imaging/mfcsc/ title="Using MFCSC" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsmultimodal_imagingmfcsc><span>MFCSC</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplestutorialsopen_data-li><a href=/pr-630/tutorials-examples/tutorials/open_data/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialsopen_data><span>Open Data</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsopen_datadatalad-li><a href=/pr-630/tutorials-examples/tutorials/open_data/datalad/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsopen_datadatalad><span>datalad</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsopen_dataosfclient-li><a href=/pr-630/tutorials-examples/tutorials/open_data/osfclient/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsopen_dataosfclient><span>osfclient</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplestutorialsprogramming-li><a href=/pr-630/tutorials-examples/tutorials/programming/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialsprogramming><span>Programming</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsprogrammingconda-li><a href=/pr-630/tutorials-examples/tutorials/programming/conda/ title="Conda environments" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsprogrammingconda><span>conda envs</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsprogrammingmatlab-li><a href=/pr-630/tutorials-examples/tutorials/programming/matlab/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsprogrammingmatlab><span>Matlab</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplestutorialsreproducibility-li><a href=/pr-630/tutorials-examples/tutorials/reproducibility/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialsreproducibility><span>Reproducibility</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsreproducibilitydatalad-run-li><a href=/pr-630/tutorials-examples/tutorials/reproducibility/datalad-run/ title="Reproducible script execution with DataLad" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsreproducibilitydatalad-run><span>datalad run</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplestutorialsspectroscopy-li><a href=/pr-630/tutorials-examples/tutorials/spectroscopy/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialsspectroscopy><span>Spectroscopy</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsspectroscopylcmodel-li><a href=/pr-630/tutorials-examples/tutorials/spectroscopy/lcmodel/ title="Spectroscopy with lcmodel" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsspectroscopylcmodel><span>lcmodel</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsspectroscopymrsiproc-li><a href=/pr-630/tutorials-examples/tutorials/spectroscopy/mrsiproc/ title="Spectroscopy pipeline" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsspectroscopymrsiproc><span>mrsiproc</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplestutorialsstructural_imaging-li><a href=/pr-630/tutorials-examples/tutorials/structural_imaging/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplestutorialsstructural_imaging><span>Structural Imaging</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsstructural_imagingfreesurfer-li><a href=/pr-630/tutorials-examples/tutorials/structural_imaging/freesurfer/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsstructural_imagingfreesurfer><span>FreeSurfer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplestutorialsstructural_imagingstructuralconnectivity-li><a href=/pr-630/tutorials-examples/tutorials/structural_imaging/structuralconnectivity/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplestutorialsstructural_imagingstructuralconnectivity><span>Structural connectivity dMRI</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-630tutorials-examplescontribute-li><a href=/pr-630/tutorials-examples/contribute/ title="Contribute Tutorials and Example Notebooks" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-630tutorials-examplescontribute><span>Contribute</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplescontributecontribute-examples-li><a href=/pr-630/tutorials-examples/contribute/contribute-examples/ title="Contribute Example Notebooks" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplescontributecontribute-examples><span>Contribute examples</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-630tutorials-examplescontributecontribute-tutorials-li><a href=/pr-630/tutorials-examples/contribute/contribute-tutorials/ title="Contribute Tutorials" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-630tutorials-examplescontributecontribute-tutorials><span>Contribute tutorials</span></a></li></ul></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-10 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/pr-630/tutorials-examples/>Tutorials & Examples</a></li><li class=breadcrumb-item><a href=/pr-630/tutorials-examples/tutorials/>Tutorials section</a></li><li class=breadcrumb-item><a href=/pr-630/tutorials-examples/tutorials/functional_imaging/>Functional Imaging</a></li><li class="breadcrumb-item active" aria-current=page>SPM</li>&nbsp;<a href=https://github.com/neurodesk/neurodesk.github.io/edit/main/content/en/tutorials-examples/tutorials/functional_imaging/spm.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i></a></ol></nav><div class=td-content><h1>Statistical Parametric Mapping (SPM)</h1><div class=lead>A tutorial for running a functional MRI analysis in SPM.</div><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://neurodesk.github.io/pr-630/tags/spm/ data-taxonomy-term=spm><span class=taxonomy-label>SPM</span></a></li><li><a class=taxonomy-term href=https://neurodesk.github.io/pr-630/tags/functional-imaging/ data-taxonomy-term=functional-imaging><span class=taxonomy-label>Functional Imaging</span></a></li></ul></div></header><blockquote><p><em>This tutorial was created by Steffen Bollmann.</em></p><p>Email: <a href=mailto:s.bollmannn@uq.edu.au>s.bollmannn@uq.edu.au</a></p><p>Github: @stebo85</p><p>Twitter: @sbollmann_MRI</p></blockquote><div class="alert alert-info" role=alert><h4 class=alert-heading>Getting Setup with Neurodesk</h4><i>For more information on getting set up with a Neurodesk environment, see <a href=/tutorials-examples>here</a></i></div><p>This tutorial is based on the excellent tutorial from Andy&rsquo;s Brain book: <a href=https://andysbrainbook.readthedocs.io/en/latest/SPM/SPM_Overview.html target=_blank rel=noopener>https://andysbrainbook.readthedocs.io/en/latest/SPM/SPM_Overview.html</a>
Our version here is a shortened and adjusted version for using on the Neurodesk platform.</p><h2 id=download-data>Download data</h2><p>First, let&rsquo;s download the data. We will use this open dataset: <a href=https://openneuro.org/datasets/ds000102/versions/00001/download target=_blank rel=noopener>https://openneuro.org/datasets/ds000102/versions/00001/download</a></p><p>Open a terminal and use datalad to install the dataset:</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>cd neurodesktop-storage
</span></span><span style=display:flex><span>datalad install https://github.com/OpenNeuroDatasets/ds000102.git</span></span></code></pre></div></div><img width=839 alt=image src=https://user-images.githubusercontent.com/4021595/197097444-900ad262-fbca-4cac-adea-3c7b67a4ecc5.png><p>We will use subject 08 as an example here, so we use datalad to download sub-08 and since SPM doesn&rsquo;t support compressed files, we need to unpack them:</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>cd ds000102
</span></span><span style=display:flex><span>datalad get sub-08/
</span></span><span style=display:flex><span>gunzip sub-08/anat/sub-08_T1w.nii.gz -f
</span></span><span style=display:flex><span>gunzip sub-08/func/sub-08_task-flanker_run-1_bold.nii.gz -f
</span></span><span style=display:flex><span>gunzip sub-08/func/sub-08_task-flanker_run-2_bold.nii.gz -f
</span></span><span style=display:flex><span>chmod a+rw sub-08/ -R</span></span></code></pre></div></div><p>The task used is described here: <a href=https://andysbrainbook.readthedocs.io/en/latest/SPM/SPM_Short_Course/SPM_02_Flanker.html target=_blank rel=noopener>https://andysbrainbook.readthedocs.io/en/latest/SPM/SPM_Short_Course/SPM_02_Flanker.html</a></p><h2 id=starting-spm-and-visualizing-the-data>Starting SPM and visualizing the data</h2><p>Start spm12GUI from the Application Menu:
<img width=727 alt=image src=https://user-images.githubusercontent.com/4021595/197098330-3c6611a1-8bbb-49da-b6fb-3752452322cc.png></p><p>When the SPM menu loaded, click on fMRI and the full SPM interface should open up:
<img width=1039 alt=image src=https://user-images.githubusercontent.com/4021595/197098528-aba8f46c-d837-4de5-80c5-07056b784c46.png></p><p>For convenience let&rsquo;s change our default directory to our example subject. Click on <code>Utils</code> and select <code>CD</code>:
<img width=404 alt=image src=https://user-images.githubusercontent.com/4021595/197101928-1bdf67a4-8945-43aa-8df3-877af03bf677.png></p><p>Then navigate to sub-08 and select the directory in the right browser window:
<img width=508 alt=image src=https://user-images.githubusercontent.com/4021595/197102015-2f646e54-0626-4139-b9ac-2ad2a77a2ab6.png></p><p>Now let&rsquo;s visualize the anatomical T1 scan of subject 08 by clicking on Display and navigating and selecting the anatomical scan:
<img width=743 alt=image src=https://user-images.githubusercontent.com/4021595/197100690-b8e7a0b8-6c0b-47fc-8c5f-46f317396361.png></p><img width=1041 alt=image src=https://user-images.githubusercontent.com/4021595/197100737-02fdc59e-94df-4895-b756-fc78e5365cfd.png><p>Now let&rsquo;s look at the functional scans. Use CheckReg and open run-01. Then right click and <code>Browse ...</code>. Then set frames to 1:146 and right click <code>Select All</code></p><img width=506 alt=image src=https://user-images.githubusercontent.com/4021595/197101637-dc486f27-083a-4849-a5af-34666a21e7a4.png><p>Now we get a slider viewer and we can investigate all functional scans:
<img width=609 alt=image src=https://user-images.githubusercontent.com/4021595/197102121-07f1b9c1-3222-4c7c-ad03-eb41e1294460.png></p><p>Let&rsquo;s check the alignment between the anatomical and the functional scans - use CheckReg and open the anatomical and the functional scan. They shouldn&rsquo;t align yet, because we haven&rsquo;t done any preprocessing yet:
<img width=1045 alt=image src=https://user-images.githubusercontent.com/4021595/197103016-509387f1-4d7e-4237-b745-ae7e837dba11.png></p><h2 id=preprocessing-the-data>Preprocessing the data</h2><h3 id=realignment>Realignment</h3><p>Select <code>Realign (Est & Reslice)</code> from the SPM Menu (the third option):
<img width=1121 alt=image src=https://user-images.githubusercontent.com/4021595/197304865-3560f16d-2950-48f4-9b19-b60f63737dc4.png></p><p>Then select the functional run (important: Select frames from 1:146 again!) and leave everything else as Defaults. Then hit run:
<img width=1120 alt=image src=https://user-images.githubusercontent.com/4021595/197304966-61159670-71ef-4542-996f-f88dab8bc1d4.png></p><p>As an output we should see the realignment parameters:
<img width=623 alt=image src=https://user-images.githubusercontent.com/4021595/197106717-0850bb27-cb72-48b1-a532-90910e3267d4.png></p><h3 id=slice-timing-correction>Slice timing correction</h3><p>Click on <code>Slice timing</code> in the SPM menu to bring up the Slice Timing section in the batch editor:
<img width=1115 alt=image src=https://user-images.githubusercontent.com/4021595/197303610-f0e989dc-8646-4c97-ae67-ac5a6b07d3e1.png></p><p>Select the realigned images (use filter <code>rsub</code> and Frames 1:146) and then enter the parameters:</p><ul><li>Number of Slices = 40</li><li>TR = 2</li><li>TA = 1.95</li><li>Slice order = [1:2:40 2:2:40]</li><li>Reference Slice = 1</li></ul><img width=697 alt=image src=https://user-images.githubusercontent.com/4021595/197303803-36496c19-66fe-46c9-9f7b-c80973f51bee.png><h3 id=coregistration>Coregistration</h3><p>Now, we coregister the functional scans and the anatomical scan.</p><p>Click on <code>Coregister (Estimate & Reslice)</code> (the third option) in the SPM menu to bring up the batch editor:
<img width=1119 alt=image src=https://user-images.githubusercontent.com/4021595/197304758-19293222-3256-4a32-8901-6741522e28ea.png></p><p>Use the Mean image as the reference and the T1 scan as the source image and hit Play:
<img width=697 alt=image src=https://user-images.githubusercontent.com/4021595/197305284-f57af4c3-cccc-4f6b-b138-8fbad9d6d51e.png></p><p>Let&rsquo;s use CheckReg again and overlay a Contour (Right Click -> Contour -> Display onto -> all) to check the coregistration between the images:
<img width=621 alt=image src=https://user-images.githubusercontent.com/4021595/197305422-8798294f-50ae-4207-b014-9c2f416a6721.png></p><h3 id=segmentation>Segmentation</h3><p>Click the <code>Segmentation</code> button in the SPM menu:
<img width=697 alt=image src=https://user-images.githubusercontent.com/4021595/197305608-08c0de6a-faf8-4ae9-ab07-664ce84df586.png></p><p>Then change the following settings:</p><ul><li>Volumes = our coregistered anatomical scan rsub-08-T1w.nii</li><li>Save Bias Corrected = Save Bias Correced</li><li>Deformation Fields = Forward</li></ul><p>and hit Play again.</p><h3 id=apply-normalization>Apply normalization</h3><p>Select <code>Normalize (Write)</code> from the SPM menu:
<img width=415 alt=image src=https://user-images.githubusercontent.com/4021595/197305894-36020b36-5e0f-4b06-8e8c-015b7e3b0ba7.png></p><p>For the Deformation Field select the y_rsub-08 file we created in the last step and for the Images to Write select the arsub-08 functional images (Filter ^ar and Frames 1:146):
<img width=515 alt=image src=https://user-images.githubusercontent.com/4021595/197306004-284c02a8-f5b4-4278-9234-3d302e4dccb5.png></p><p>Hit Play again.</p><h3 id=checking-the-normalization>Checking the normalization</h3><p>Use CheckReg to make sure that the functional scans (starting with w to indicate that they were warped: warsub-08) align with the template (found in /opt/spm12/spm12_mcr/spm12/spm12/canonical/avg305T1.nii):</p><img width=621 alt=image src=https://user-images.githubusercontent.com/4021595/197306204-c635b3f5-6e89-40de-9c04-5d94dfec10fc.png><h3 id=smoothing>Smoothing</h3><p>Click the <code>Smooth</code> button in the SPM menu and select the warped functional scans:
<img width=514 alt=image src=https://user-images.githubusercontent.com/4021595/197306354-60ee76e2-73ac-4fe8-8387-038d10580c99.png></p><p>Then click Play.</p><p>You can check the smoothing by using CheckReg again:
<img width=624 alt=image src=https://user-images.githubusercontent.com/4021595/197306424-8c407cd5-7ba9-4ae3-83ee-4fa8ec22e41f.png></p><h2 id=analyzing-the-data>Analyzing the data</h2><p>Click on <code>Specify 1st-level</code> - then set the following options:</p><ul><li>Directory: Select the sub-08 top level directory</li><li>Units for design: Seconds</li><li>Interscan interval: 2</li><li>Data & Design: Click twice on New Subject/Session</li><li>Select the smoothed, warped data from run 1 and run 2 for the two sessions respectively</li><li>Create two Conditions per run and set the following:</li><li>For Run 1:</li><li>Name: Inc</li><li>Onsets (you can copy from here and paste with CTRL-V): 0 10 20 52 88 130 144 174 236 248 260 274</li><li>Durations: 2 (SPM will assume that it&rsquo;s the same for each event)</li><li>Name: Con</li><li>Onsets: 32 42 64 76 102 116 154 164 184 196 208 222</li><li>Durations: 2</li><li>For Run 2:</li><li>Name: Inc</li><li>Onsets: 0 10 52 64 88 150 164 174 184 196 232 260</li><li>Durations: 2</li><li>Name: Con</li><li>Onsets: 20 30 40 76 102 116 130 140 208 220 246 274</li><li>Durations: 2</li></ul><p>When done, click the green Play button.</p><p>We can Review the design by clicking on <code>Review</code> in the SPM menu and selecting the SPM.mat file in the model directory we specified earlier and it should look like this:
<img width=626 alt=image src=https://user-images.githubusercontent.com/4021595/197309811-da1fb6d2-1eb3-4ed8-9fe7-560292b645a4.png></p><h3 id=estimating-the-model>Estimating the model</h3><p>Click on <code>Estimate</code> in the SPM menu and select the SPM.mat file, then hit the green Play button.</p><h3 id=inference>Inference</h3><p>Now open the <code>Results</code> section and select the SPM.mat file again. Then we can test our hypotheses:</p><p>Define a new contrast as:</p><ul><li>Name: Incongruent-Congruent</li><li>Contrast weights vector: 0.5 -0.5 0.5 -0.5</li></ul><img width=518 alt=image src=https://user-images.githubusercontent.com/4021595/197309988-5f09952a-fc3d-4a8b-9797-22dbdd165e12.png><p>Then we can view the results. Set the following options:</p><ul><li>masking: none”</li><li>p value adjustment to control: Click on “none”, and set the uncorrected p-value to 0.01.</li><li>extent threshold {voxels}: 10</li></ul><img width=622 alt=image src=https://user-images.githubusercontent.com/4021595/197310053-cde3d7cb-9af1-4a5b-8923-6c26b7b2a5ee.png><div class=section-index></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Mastodon aria-label=Mastodon><a target=_blank rel=noopener href=https://masto.ai/@Neurodesk aria-label=Mastodon><i class="fab fa-mastodon responsive-icon"></i>&nbsp;&nbsp;Mastodon</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Discussion aria-label=Discussion><a target=_blank rel=noopener href=https://github.com/orgs/neurodesk/discussions aria-label=Discussion><i class="fa fa-envelope responsive-icon"></i>&nbsp;&nbsp;Discussion</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Acknowledgements aria-label=Acknowledgements><a href=/overview/acknowledgement/ aria-label=Acknowledgements><i class="fa fa-handshake responsive-icon"></i>&nbsp;&nbsp;Acknowledgements</a></li></ul></div><div class="col-6 col-sm-4 text-end text-xs-center order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Metrics aria-label=Metrics><a href=/docs/overview/metrics aria-label=Metrics><i class="fa fa-signal responsive-icon"></i>&nbsp;&nbsp;Metrics</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Uptime aria-label=Uptime><a target=_blank rel=noopener href=https://stats.uptimerobot.com/NBE38IZWZM aria-label=Uptime><i class="fa fa-circle responsive-icon"></i>&nbsp;&nbsp;Uptime</a></li></ul></div><div class="td-footer__copyright-etc col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js crossorigin=anonymous></script></div><script src=/pr-630/js/main.js></script><script defer src=/pr-630/js/click-to-copy.js crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3.8.2 integrity="sha512-lsD+XVzdBI6ZquXc8gqbw0/bgrfIsMJwY/8xvmvbN+U3gZSeG7BXQoCq4zv/yCmntR2GLHtgB+bD4ESPsKIbIA==" crossorigin=anonymous></script><script type=text/javascript>const containers=["#docsearch-0","#docsearch-1"];for(let e of containers)docsearch({container:e,appId:"P5JEPQ5LZ2",apiKey:"56c6d9a954f7df2a98dcedb2763af8c4",indexName:"neurodesk"})</script><script src=/pr-630/js/tabpane-persist.js></script></body></html>