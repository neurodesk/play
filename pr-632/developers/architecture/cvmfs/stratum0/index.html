<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/pr-632/static/favicons/favicon.ico><link rel=apple-touch-icon href=/pr-632/static/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/pr-632/static/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/pr-632/static/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/pr-632/static/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/pr-632/static/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/pr-632/static/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/pr-632/static/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/pr-632/static/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/pr-632/static/favicons/android-192x192.png sizes=192x192><title>Setup Stratum 0 server | Neurodesk</title>
<meta name=description content="Host a Stratum 0 server"><meta property="og:url" content="https://neurodesk.github.io/pr-632/developers/architecture/cvmfs/stratum0/"><meta property="og:site_name" content="Neurodesk"><meta property="og:title" content="Setup Stratum 0 server"><meta property="og:description" content="Host a Stratum 0 server"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="developers"><meta property="article:modified_time" content="2025-11-11T09:52:54+10:00"><meta itemprop=name content="Setup Stratum 0 server"><meta itemprop=description content="Host a Stratum 0 server"><meta itemprop=dateModified content="2025-11-11T09:52:54+10:00"><meta itemprop=wordCount content="426"><meta name=twitter:card content="summary"><meta name=twitter:title content="Setup Stratum 0 server"><meta name=twitter:description content="Host a Stratum 0 server"><link href=/pr-632/scss/main.css rel=stylesheet><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3.8.2 integrity="sha512-l7pkV1dOURFyHCeH8I4fK9lCkQKuqhlsTCqRl3zktifDlB8oTUJ+mJPgYkK9kHpUut8j1iPquTv32t6hvTPv3g==" crossorigin=anonymous></head><body class=td-page><header><nav class="td-navbar navbar-expand-xl navbar-dark bg-dark"><div class="container-fluid flex-md-row"><a class=navbar-brand href=/pr-632/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" viewBox="0 0 560.3 82.7"><defs><style>.st0{isolation:isolate}.st1{fill:#6ba442}.st2{fill:#fff}</style></defs><g class="st0"><path class="st2" d="M30.2 73.4h-9.9v-60h9.8l33.3 44.8V13.4h10.1v60H63.4L30.1 29.1v44.3z"/><path class="st2" d="M85.8 13.4h45l-1.4 10.3-33.8-.2v13.6l20.1-.2v11.4H95.6v13.5H129l1.8 11.6h-45v-60z"/><path class="st2" d="M141.4 13.4h9.9v50.2h28.2V13.4h9.9v51.4c0 1.2-.2 2.3-.7 3.3-.4 1-1.1 2-1.8 2.7-.8.8-1.7 1.4-2.8 1.8-1.1.4-2.2.7-3.3.7h-30.7c-1.2.0-2.3-.2-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7s-.7-2.2-.7-3.3V13.4z"/><path class="st2" d="M244.7 34.8c0 4.6-1.4 7.9-4.3 10-4 2.9-8.4 4.4-13.2 4.4l17.5 24.3h-12.1l-14.7-24h-9.5v24h-8.5V13.4h29.8c10 0 15 4.9 15 14.6v6.8zm-36.3 6h15.2c3.9-.2 6.6-.7 8-1.6 2.6-1.8 3.9-2.9 3.9-3.5V29c0-2.2-.6-3.9-1.7-5-1.4-1.4-3-2.1-4.7-2.1h-20.8v18.9z"/><path class="st2" d="M306.5 59.4c0 4.8-.3 7.7-.6 8.7-.3.9-.9 1.8-1.8 2.8s-1.7 1.3-3.1 1.8c-1.3.5-3.6.7-6.8.7h-27.1c-1.2.0-2.8-.2-5-.6-2.5-.5-3.9-1.1-4.4-1.8-.9-1.5-1.6-2.4-1.8-2.7-.4-.6-.7-3.6-.7-8.7V42.1c0-8.8.0-14.1.2-15.9.0-2.6.3-5 .7-7.4.1-.8.7-1.7 1.7-2.7.6-.7 2.1-1.3 4.4-1.8 1.9-.4 3.5-.7 5-.7h27.1c3.5.0 5.7.1 6.8.6 1.3.5 2.3 1.1 3.1 1.9.9.8 1.5 1.7 2 2.7.4.8.6 3.3.6 7.4l.2 16.7c0 8.1-.1 13.6-.3 16.7zM265.4 23.3v40h31.2v-40h-31.2z"/></g><g class="st0"><path class="st1" d="M316.2 73.4v-60l31.3.3c2.5.0 5.4.6 8.7 1.9 2.6 1 4.8 2.4 6.6 4.3 2 2 3.4 4.2 4.3 6.6 1 3 1.5 5.9 1.5 8.7v17.3c0 3.2-.5 6.1-1.5 8.7s-2.4 4.8-4.2 6.6-4 3.2-6.6 4.2-5.5 1.5-8.7 1.5h-31.3zm30.7-11.2c4.9.0 8-.7 9.2-2 2.1-2.3 3.2-5.8 3.2-10.4v-14c.2-1.9-.2-3.6-1.1-5.2-.8-1.5-1.8-2.8-2.9-3.9-1.1-1.1-2.4-1.9-3.9-2.4-1.5-.6-3-.8-4.4-.8h-21.3v38.8h21.2z"/><path class="st1" d="M381 13.4h45l-1.4 10.3-33.8-.2v13.6l20.1-.2v11.4h-20.1v13.5h33.4l1.8 11.6h-45v-60z"/><path class="st1" d="M446.4 46.5c-1.1.0-2.2-.3-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7-.4-1-.7-2.2-.7-3.3V22.1c0-1.2.2-2.3.7-3.3s1.1-2 1.8-2.7 1.7-1.4 2.8-1.8 2.2-.7 3.3-.7h29.1c1.2.0 2.3.2 3.3.7s1.9 1.1 2.7 1.8c1.1 1 1.7 2 1.8 2.8l.7 3.3v6.7l-9 2.7v-7.7h-28.7v14.3l29.1.5c1.2.0 2.3.3 3.3.7 1.1.4 2 1.1 2.8 1.8.8.8 1.4 1.7 1.8 2.7.4 1 .7 2.2.7 3.3V65c0 1.2-.2 2.3-.7 3.3-.4 1-1.1 2-1.8 2.7-.8.8-1.7 1.4-2.7 1.8-1 .4-2.1.7-3.3.7h-30c-1.2.0-2.3-.2-3.3-.7-1.1-.4-2-1.1-2.8-1.8-.8-.8-1.4-1.7-1.8-2.7-.4-1-.7-2.2-.7-3.3v-7.7l9.5-1.6v7.7h28.7V47.2l-28.7-.5z"/><path class="st1" d="M505.4 13.4v23.9l26.2-23.9h12.9l-30.8 27.4 32.1 32.6h-12.9l-27.5-28.1v28.1h-10.6v-60h10.6z"/></g></svg></span></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=main_navbar><ul class="navbar-nav ms-auto mt-2 mt-lg-0"><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=/pr-632/overview/><span>Overview</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=/pr-632/getting-started/><span>Getting Started</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=/pr-632/tutorials-examples/><span>Tutorials & Examples</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class="nav-link active" href=/pr-632/developers/><span class=active>Developer Documentation</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/neurodesk target=_blank><span>GitHub</span></a></li><li class="nav-item ml-4 mb-2 mb-lg-0"><a class=nav-link href=/pr-632/contact/><span>Contact</span></a></li></ul><div class="navbar-nav d-lg-block"><div class=td-search><div class=td-search--algolia id=docsearch-0></div></div></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class=td-search><div class=td-search--algolia id=docsearch-0></div></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-pr-632developers-li><a href=/pr-632/developers/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-pr-632developers><span>Developer Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developerscontributors-li><a href=/pr-632/developers/contributors/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developerscontributors><span>Contributors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-pr-632developersarchitecture-li><a href=/pr-632/developers/architecture/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developersarchitecture><span>Architecture</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersarchitectureneurodesk-components-li><a href=/pr-632/developers/architecture/neurodesk-components/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitectureneurodesk-components><span>Neurodesk Architecture</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersarchitecturerelease_process-li><a href=/pr-632/developers/architecture/release_process/ title="Neurodesktop Release Process" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitecturerelease_process><span>Release Process</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersarchitectureneurodesk-dev-li><a href=/pr-632/developers/architecture/neurodesk-dev/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitectureneurodesk-dev><span>Neurodesktop Dev</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersarchitecturetransparent_singularity-li><a href=/pr-632/developers/architecture/transparent_singularity/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitecturetransparent_singularity><span>Transparent Singularity</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-pr-632developersarchitecturecvmfs-li><a href=/pr-632/developers/architecture/cvmfs/ title="Neurodesk CVMFS" class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developersarchitecturecvmfs><span>CVMFS</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersarchitecturecvmfsproxy-li><a href=/pr-632/developers/architecture/cvmfs/proxy/ title="Setup CVMFS Proxy" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitecturecvmfsproxy><span>Proxy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersarchitecturecvmfscvmfs_architecture-li><a href=/pr-632/developers/architecture/cvmfs/cvmfs_architecture/ title="CVMFS architecture" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitecturecvmfscvmfs_architecture><span>Setup</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-pr-632developersarchitecturecvmfsstratum0-li><a href=/pr-632/developers/architecture/cvmfs/stratum0/ title="Setup Stratum 0 server" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitecturecvmfsstratum0><span class=td-sidebar-nav-active-item>Stratum 0</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersarchitecturecvmfsstratum1-li><a href=/pr-632/developers/architecture/cvmfs/stratum1/ title="Setup Stratum 1 server" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitecturecvmfsstratum1><span>Stratum 1</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersarchitectureroadmap-li><a href=/pr-632/developers/architecture/roadmap/ title="Project Roadmap" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersarchitectureroadmap><span>Roadmap</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-632developersneurocontainer-copilot-li><a href=/pr-632/developers/neurocontainer-copilot/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developersneurocontainer-copilot><span>Neurocontainer Copilot</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersneurocontainer-copilotgoogle-jules-li><a href=/pr-632/developers/neurocontainer-copilot/google-jules/ title="Neurocontainer Copilot using Google Jules agent" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersneurocontainer-copilotgoogle-jules><span>Google Jules agent</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersneurocontainer-copilotopenai-codex-li><a href=/pr-632/developers/neurocontainer-copilot/openai-codex/ title="Neurocontainer Copilot using OpenAI Codex agent" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersneurocontainer-copilotopenai-codex><span>OpenAI Codex agent</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-632developersneurodesk-copilot-li><a href=/pr-632/developers/neurodesk-copilot/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developersneurodesk-copilot><span>Neurodesk Copilot</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersneurodesk-copilotgithub-copilot-li><a href=/pr-632/developers/neurodesk-copilot/github-copilot/ title="Neurodesk Copilot using Github Copilot" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersneurodesk-copilotgithub-copilot><span>Github Copilot</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersneurodesk-copilotlocal-language-models-li><a href=/pr-632/developers/neurodesk-copilot/local-language-models/ title="Neurodesk Copilot using Local LLMs" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersneurodesk-copilotlocal-language-models><span>Local LLMs</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-632developersdocumentation-li><a href=/pr-632/developers/documentation/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developersdocumentation><span>Documentation</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersdocumentationalgolia-indexing-li><a href=/pr-632/developers/documentation/algolia-indexing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersdocumentationalgolia-indexing><span>Indexing with Algolia</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersdocumentationlocal-hugo-docsy-li><a href=/pr-632/developers/documentation/local-hugo-docsy/ title="Running the Neurodesk Site Locally (Hugo + Docsy)" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersdocumentationlocal-hugo-docsy><span>Local Hugo Docsy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersdocumentationcreating-website-content-li><a href=/pr-632/developers/documentation/creating-website-content/ title="Contribute to Neurodesk.org" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersdocumentationcreating-website-content><span>Contribute Content</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-pr-632developersnew_tools-li><a href=/pr-632/developers/new_tools/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developersnew_tools><span>How to add new tools</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersnew_toolsnew_tool-li><a href=/pr-632/developers/new_tools/new_tool/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersnew_toolsnew_tool><span>New tool</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersnew_toolsupdate_tool-li><a href=/pr-632/developers/new_tools/update_tool/ title="Update tool in Neurodesk" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-pr-632developersnew_toolsupdate_tool><span>Update tool</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersdesigner-li><a href=/pr-632/developers/designer/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developersdesigner><span>Designer Guide</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-pr-632developersinterfacing-li><a href=/pr-632/developers/interfacing/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-pr-632developersinterfacing><span>Interfacing</span></a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-10 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/pr-632/developers/>Developer Documentation</a></li><li class=breadcrumb-item><a href=/pr-632/developers/architecture/>Architecture</a></li><li class=breadcrumb-item><a href=/pr-632/developers/architecture/cvmfs/>CVMFS</a></li><li class="breadcrumb-item active" aria-current=page>Stratum 0</li>&nbsp;<a href=https://github.com/neurodesk/neurodesk.github.io/edit/main/content/en/developers/architecture/cvmfs/stratum0.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i></a></ol></nav><div class=td-content><h1>Setup Stratum 0 server</h1><div class=lead>Host a Stratum 0 server</div><header class=article-meta></header><h2 id=setup-a-stratum-0-server>Setup a Stratum 0 server:</h2><h3 id=setup-storage>Setup Storage</h3><p>(would object storage be better? -> see comment below under next iteration ideas)</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>lsblk -l
</span></span><span style=display:flex><span>sudo mkfs.ext4 /dev/vdb
</span></span><span style=display:flex><span>sudo mkdir /storage
</span></span><span style=display:flex><span>sudo mount /dev/vdb /storage/ -t auto
</span></span><span style=display:flex><span>sudo chown ec2-user /storage/
</span></span><span style=display:flex><span>sudo chmod a+rwx /storage/</span></span></code></pre></div></div><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo vi /etc/fstab
</span></span><span style=display:flex><span>/dev/vdb  /storage    auto    defaults,nofail   <span style=color:#0550ae>0</span>  <span style=color:#0550ae>2</span></span></span></code></pre></div></div><h3 id=setup-server>Setup server</h3><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo yum install vim htop gcc git screen
</span></span><span style=display:flex><span>sudo timedatectl set-timezone Australia/Brisbane
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo yum install -y https://ecsft.cern.ch/dist/cvmfs/cvmfs-release/cvmfs-release-latest.noarch.rpm
</span></span><span style=display:flex><span>sudo yum install -y cvmfs cvmfs-server
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo systemctl <span style=color:#6639ba>enable</span> httpd
</span></span><span style=display:flex><span>sudo systemctl restart httpd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a># sudo systemctl stop firewalld</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a># restore keys:</span>
</span></span><span style=display:flex><span>sudo mkdir /etc/cvmfs/keys/incoming
</span></span><span style=display:flex><span>sudo chmod a+rwx /etc/cvmfs/keys/incoming
</span></span><span style=display:flex><span><span style=color:#6639ba>cd</span> connections/cvmfs_keys/
</span></span><span style=display:flex><span>scp neuro* ec2-user@203.101.226.164:/etc/cvmfs/keys/incoming
</span></span><span style=display:flex><span>sudo mv /etc/cvmfs/keys/incoming/* /etc/cvmfs/keys/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a>#backup keys: </span>
</span></span><span style=display:flex><span><span style=color:#57606a>#mkdir cvmfs_keys</span>
</span></span><span style=display:flex><span><span style=color:#57606a>#scp opc@158.101.127.61:/etc/cvmfs/keys/neuro* .</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo cvmfs_server mkfs -o <span style=color:#953800>$USER</span> neurodesk.ardc.edu.au
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6639ba>cd</span> /storage
</span></span><span style=display:flex><span>sudo mkdir -p cvmfs-storage/srv/
</span></span><span style=display:flex><span><span style=color:#6639ba>cd</span> /srv/
</span></span><span style=display:flex><span>sudo mv cvmfs/ /storage/cvmfs-storage/srv/
</span></span><span style=display:flex><span>sudo ln -s /storage/cvmfs-storage/srv/cvmfs/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6639ba>cd</span> /var/spool
</span></span><span style=display:flex><span>sudo mkdir /storage/spool
</span></span><span style=display:flex><span>sudo mv cvmfs/ /storage/spool/
</span></span><span style=display:flex><span>sudo ln -s  /storage/spool/cvmfs .
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cvmfs_server transaction neurodesk.ardc.edu.au
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cvmfs_server publish neurodesk.ardc.edu.au</span></span></code></pre></div></div><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo vi /etc/cron.d/cvmfs_resign</span></span></code></pre></div></div><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#0550ae>0</span> <span style=color:#0550ae>11</span> * * <span style=color:#0550ae>1</span> root /usr/bin/cvmfs_server resign neurodesk.ardc.edu.au</span></span></code></pre></div></div><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /etc/cvmfs/keys/neurodesk.ardc.edu.au.pub</span></span></code></pre></div></div><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuV9JBs9uXBR83qUs7AiE
</span></span><span style=display:flex><span>nSQfvh6VCdNigVzOfRMol5cXsYq3cFy/Vn1Nt+7SGpDTQArQieZo4eWC9ww2oLq0
</span></span><span style=display:flex><span>vY1pWyAms3Y4i+IUmMbwNifDU4GQ1KN9u4zl9Peun2YQCLE7mjC0ZLQtLM7Q0Z8h
</span></span><span style=display:flex><span>NwP8jRJTN+u8mRKzkyxfSMLscVMKhm2pAwnT1zB9i3bzVV+FSnidXq8rnnzNHMgv
</span></span><span style=display:flex><span>tfqx1h0gVyTeodToeFeGG5vq69wGZlwEwBJWVRGzzr+a8dWNBFMJ1HxamrBEBW4P
</span></span><span style=display:flex><span>AxOKGHmQHTGbo+tdV/K6ZxZ2Ry+PVedNmbON/EPaGlI8Vd0fascACfByqqeUEhAB
</span></span><span style=display:flex><span>dQIDAQAB
</span></span><span style=display:flex><span>-----END PUBLIC KEY-----</span></span></code></pre></div></div><h2 id=next-iteration-of-this>Next iteration of this:</h2><h3 id=use-object-storage>use object storage?</h3><ul><li>current implementation uses block storage, but this makes increasing the volume size a bit more work</li><li>we couldn&rsquo;t get object storage to work on Oracle as it assumes AWS S3 -> Try again on AWS</li></ul><h3 id=optimize-settings-for-repositories-for-container-images>Optimize settings for repositories for Container Images</h3><p>from the CVMFS documentation:
Repositories containing Linux container image contents (that is: container root file systems) should use overlayfs as a union file system and have the following configuration:</p><pre><code>CVMFS_INCLUDE_XATTRS=true
CVMFS_VIRTUAL_DIR=true
</code></pre><p>Extended attributes of files, such as file capabilities and SElinux attributes, are recorded. And previous file system revisions can be accessed from the clients.</p><h2 id=currently-not-used>Currently not used</h2><p>We tested the DUCC tool in the beginning, but it was leading to too many docker pulls and we therefore replaced it with our own script: <a href=https://github.com/neurodesk/neurocommand/blob/main/cvmfs/sync_containers_to_cvmfs.sh target=_blank rel=noopener>https://github.com/neurodesk/neurocommand/blob/main/cvmfs/sync_containers_to_cvmfs.sh</a></p><p>This is the old DUCC setup</p><div class=highlight><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo yum install cvmfs-ducc.x86_64
</span></span><span style=display:flex><span>sudo -i
</span></span><span style=display:flex><span>dnf install -y yum-utils 
</span></span><span style=display:flex><span>yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
</span></span><span style=display:flex><span>dnf install docker-ce docker-ce-cli containerd.io
</span></span><span style=display:flex><span>systemctl <span style=color:#6639ba>enable</span> docker
</span></span><span style=display:flex><span>systemctl start docker
</span></span><span style=display:flex><span>docker version
</span></span><span style=display:flex><span>docker info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a># leave root mode</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo groupadd docker
</span></span><span style=display:flex><span>sudo usermod -aG docker <span style=color:#953800>$USER</span>
</span></span><span style=display:flex><span>sudo chown root:docker /var/run/docker.sock
</span></span><span style=display:flex><span>newgrp docker
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>vi convert_appsjson_to_wishlist.sh
</span></span><span style=display:flex><span><span style=color:#6639ba>export</span> <span style=color:#953800>DUCC_DOCKER_REGISTRY_PASS</span><span style=color:#0550ae>=</span>configure_secret_password_here_and_dont_push_to_github
</span></span><span style=display:flex><span><span style=color:#6639ba>cd</span> neurodesk
</span></span><span style=display:flex><span>git pull
</span></span><span style=display:flex><span>./gen_cvmfs_wishlist.sh
</span></span><span style=display:flex><span>cvmfs_ducc convert recipe_neurodesk_auto.yaml
</span></span><span style=display:flex><span><span style=color:#6639ba>cd</span> ..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>chmod +x convert_appsjson_to_wishlist.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>git clone https://github.com/neurodesk/neurodesk/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a># setup cron job</span>
</span></span><span style=display:flex><span>sudo vi /etc/cron.d/cvmfs_dockerpull
</span></span><span style=display:flex><span>*/5 * * * * opc <span style=color:#6639ba>cd</span> ~ <span style=color:#0550ae>&amp;&amp;</span> bash /home/opc/convert_appsjson_to_wishlist.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a>#vi recipe.yaml</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a>##version: 1</span>
</span></span><span style=display:flex><span><span style=color:#57606a>#user: vnmd</span>
</span></span><span style=display:flex><span><span style=color:#57606a>#cvmfs_repo: neurodesk.ardc.edu.au</span>
</span></span><span style=display:flex><span><span style=color:#57606a>#output_format: &#39;$(scheme)://$(registry)/vnmd/thin_$(image)&#39;</span>
</span></span><span style=display:flex><span><span style=color:#57606a>#input:</span>
</span></span><span style=display:flex><span><span style=color:#57606a>#- &#39;https://registry.hub.docker.com/vnmd/tgvqsm_1.0.0:20210119&#39;</span>
</span></span><span style=display:flex><span><span style=color:#57606a>#- &#39;https://registry.hub.docker.com/vnmd/itksnap_3.8.0:20201208&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a>#cvmfs_ducc convert recipe_neurodesk.yaml</span>
</span></span><span style=display:flex><span><span style=color:#57606a>#cvmfs_ducc convert recipe_unpacked.yaml</span></span></span></code></pre></div></div><div class=section-index></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Mastodon aria-label=Mastodon><a target=_blank rel=noopener href=https://masto.ai/@Neurodesk aria-label=Mastodon><i class="fab fa-mastodon responsive-icon"></i>&nbsp;&nbsp;Mastodon</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Discussion aria-label=Discussion><a target=_blank rel=noopener href=https://github.com/orgs/neurodesk/discussions aria-label=Discussion><i class="fa fa-envelope responsive-icon"></i>&nbsp;&nbsp;Discussion</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Acknowledgements aria-label=Acknowledgements><a href=/overview/acknowledgement/ aria-label=Acknowledgements><i class="fa fa-handshake responsive-icon"></i>&nbsp;&nbsp;Acknowledgements</a></li></ul></div><div class="col-6 col-sm-4 text-end text-xs-center order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Metrics aria-label=Metrics><a href=/docs/overview/metrics aria-label=Metrics><i class="fa fa-signal responsive-icon"></i>&nbsp;&nbsp;Metrics</a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Uptime aria-label=Uptime><a target=_blank rel=noopener href=https://stats.uptimerobot.com/NBE38IZWZM aria-label=Uptime><i class="fa fa-circle responsive-icon"></i>&nbsp;&nbsp;Uptime</a></li></ul></div><div class="td-footer__copyright-etc col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js crossorigin=anonymous></script></div><script src=/pr-632/js/main.js></script><script defer src=/pr-632/js/click-to-copy.js crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3.8.2 integrity="sha512-lsD+XVzdBI6ZquXc8gqbw0/bgrfIsMJwY/8xvmvbN+U3gZSeG7BXQoCq4zv/yCmntR2GLHtgB+bD4ESPsKIbIA==" crossorigin=anonymous></script><script type=text/javascript>const containers=["#docsearch-0","#docsearch-1"];for(let e of containers)docsearch({container:e,appId:"P5JEPQ5LZ2",apiKey:"56c6d9a954f7df2a98dcedb2763af8c4",indexName:"neurodesk"})</script><script src=/pr-632/js/tabpane-persist.js></script></body></html>